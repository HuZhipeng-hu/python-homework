import pyodbc

# 1. 连接数据库
DB_SERVER   = '(local)'       # 根据你的实际情况修改
DB_NAME     = 'Student'
DB_USER     = 'sa'
DB_PASSWORD = 'H1314.nice'

conn_str = (
    'DRIVER={SQL Server};'
    f'SERVER={DB_SERVER};'
    f'DATABASE={DB_NAME};'
    f'UID={DB_USER};'
    f'PWD={DB_PASSWORD}'
)
conn = pyodbc.connect(conn_str)
cursor = conn.cursor()

# 2. （可选）先删掉表，再重建——避免重复执行时报错
'''cursor.execute("IF OBJECT_ID('questions', 'U') IS NOT NULL DROP TABLE questions;")

# 3. 创建 questions 表
cursor.execute("""
CREATE TABLE questions (
    id            INT IDENTITY(1,1) PRIMARY KEY,
    question_text NVARCHAR(MAX)    NOT NULL
)
""")
conn.commit()

# 4. 你的问题列表
questions = [
        "最近一星期，您是否有时感到心情有些低落，情绪不太愉快呢？",
    "您是否发现最近一周中，有时心情特别沉重？",
    "在过去的七天内，您是否经历了情绪上的一些波动？",
    "您有没有感觉到，近来有时候不太开心，情绪有点低落？",
    "最近一星期，您是否有时觉得早晨的时光特别美好？",
    "在过去的一周，您是否发现自己更享受早晨的时光呢？",
    "最近几天里，您是否觉得早晨是一天中最让人放松的时刻？",
    "您有没有注意到，最近一周中早晨的感觉似乎更让您愉悦？",
    "最近一星期，您是否有时会不由自主地想哭，或者真的哭出来？",
    "在过去的几天中，您是否感到有时候情绪会突然涌上心头？",
    "您有没有发现，最近几天情绪波动时，想哭的感觉变得频繁？",
    "最近一周，您是否经历过一些让您想哭的情绪瞬间？",
    "最近一星期，您是否有时感觉晚上睡得不太好？",
    "在最近的日子里，您是否有过失眠或睡眠不佳的情况？",
    "您是否注意到，过去一周的夜晚似乎不如以往安宁？",
    "最近几天里，您是否感觉晚上很难入睡，或者睡眠质量不高？",
    "最近一星期，您是否与平时一样保持正常的饮食？",
    "您最近一周的饮食习惯是否有变化，还是与往常一样？",
    "在过去的几天中，您是否觉得自己吃得和以前一样多？",
    "您有没有感受到，最近一周的饮食量与往常相比有差异？",
    "最近一星期，您与异性互动时是否依然感到愉快？",
    "在最近的日子里，您与异性相处的感觉是否仍然如往常一样？",
    "您有没有发现，过去一周与异性交流时的愉悦感有所变化？",
    "最近几天中，您是否感到与异性接触时的乐趣依旧？",
    "最近一星期，您是否注意到自己的体重有所下降？",
    "在过去的一周里，您是否发现自己体重有变化，似乎在减少？",
    "您是否感受到最近几天体重的变化，可能有下降的趋势？",
    "最近一周，您有没有留意到自己的体重似乎在下降？",
    "最近一星期，您是否有便秘的困扰？",
    "在最近的几天中，您是否经历过便秘的问题？",
    "您是否注意到，过去一周的排便情况与平时相比有所不同？",
    "最近几天，您有没有觉得便秘带来的不适感？",
    "最近一星期，您是否感觉心跳比平时快？",
    "在过去的一周内，您是否发现心跳有时候显得有些急促？",
    "您有没有意识到，最近几天心跳的频率似乎有所增加？",
    "最近一周中，您是否感到心跳的速度与往常相比有所变化？",
    "最近一星期，您是否有时感到无缘无故的疲惫？",
    "在最近的几天中，您是否感到时常无力，似乎没有原因？",
    "您是否注意到，过去一周内，自己常常觉得疲倦？",
    "最近几天里，您有没有觉得疲乏感比平时更明显？",
    "最近一星期，您的思维是否依然清晰如往常？",
    "在过去的几天中，您是否觉得自己的思维状态与以往一样？",
    "您有没有感受到，最近一周思维的清晰度有所改变？",
    "最近几天里，您是否觉得自己的脑子依然清楚？",
    "最近一星期，您是否经常觉得做事情并没有太大困难？",
    "在最近的日子中，您是否觉得完成任务还是很轻松的？",
    "您有没有注意到，过去一周内做事情似乎变得更简单？",
    "最近几天里，您是否觉得自己面临的挑战并不困难？",
    "最近一星期，您是否有时感到不安，难以平静下来？",
    "在过去的一周里，您是否经历了一些让人感到焦虑的时刻？",
    "您有没有发现，最近几天的心情有些烦躁，难以安定？",
    "最近几天中，您是否感到内心有些不安，难以放松？",
    "最近一星期，您是否对未来仍然抱有希望？",
    "在过去的一周里，您是否感受到对未来的积极展望？",
    "您有没有发现，最近几天对未来的看法依然乐观？",
    "最近一周中，您是否觉得未来依然充满可能性？",
    "最近一星期，您是否有时比平常更容易激动？",
    "在过去的几天中，您是否感觉情绪变得更加敏感？",
    "您有没有注意到，最近一周内自己更易受到情绪的影响？",
    "最近几天里，您是否发现自己更容易对事情感到兴奋或激动？",
    "最近一星期，您是否觉得做决定变得更加容易？",
    "在最近的日子里，您是否发现自己在做决定时更为果断？",
    "您有没有感受到，过去一周中做出选择的过程变得轻松？",
    "最近几天中，您是否觉得做决定的难度有所降低？",
    "最近一星期，您是否觉得自己是个有用的人，有人需要您？",
    "在过去的一周里，您是否感到自己对他人的价值和重要性？",
    "您有没有注意到自己在他人生活中发挥的积极作用？",
    "最近几天，您是否觉得自己被他人需要，感到有用？",
    "最近一星期，您是否觉得生活过得很有意思？",
    "在过去的一周中，您是否发现生活中有许多值得期待的事情？",
    "您有没有感受到，最近几天的生活让您感到充实和快乐？",
    "最近几天里，您是否觉得生活的乐趣依然存在？",
    "最近一星期，您是否有时会想，如果自己不在，别人会过得更好？",
    "最近您有没有想过，自己是否让周围的人感到负担，甚至觉得自己不在了会让他们的生活变得更好",
    "在最近的一段时间里，您是否有过类似的感受，觉得如果自己不在，可能会让身边的人更快乐一些",
    "最近几天中，您是否曾想到自己的存在是否对他人有所帮助？",
    "最近一星期，您是否对平常感兴趣的事物依然保持兴趣？",
    "在过去的一周里，您是否发现自己仍然喜欢以前的爱好？",
    "您有没有感受到，最近几天中对自己热爱的事情的兴趣有所保持？",
    "最近几天中，您是否觉得自己对往常感兴趣的事物依旧感兴趣？"
]

# 5. 批量插入
#    executemany 的参数要是可迭代的 tuple 列表
rows = [(q,) for q in questions]
cursor.executemany(
    "INSERT INTO questions (question_text) VALUES (?);",
    rows
)
conn.commit()'''

cursor.execute("SELECT id, question_text FROM questions;")
rows = cursor.fetchall()

for r in rows:
    print(r.id, r.question_text)
# 6. 验证一下
cursor.execute("SELECT COUNT(*) FROM questions;")
print("总共插入了：", cursor.fetchone()[0], "条记录")

# 7. 关闭连接
conn.close()
